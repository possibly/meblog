<!doctype html>
<html class="theme-next use-motion">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>




  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.3.0"/>




	<meta name="keywords" content="mateas, michael, interactive, storytelling, story, telling, santa, cruz, uc, class, schema, content, selection, architecture, games, game, system, systems, 2016, framework, content, cavern, doom, dragon's, dragon, dragons, lair, ufo, 54-40," />

  <title> Schema for Content Selection Architectures // Tyler Brothers </title>
</head>

<body>
  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
    <a href="/" class="brand">
        <span class="logo">
          <i class="icon-logo"></i>
        </span>
        <span class="site-title">Tyler Brothers</span>
    </a>
</h1>


  <ul id="menu" class="menu">
    
      
          
            <li class="menu-item menu-item-home">
              <a href="/">
                <i class="menu-item-icon icon-home"></i> <br />
          
          home
        </a>
      </li>
    
      
          
            <li class="menu-item menu-item-archives">
              <a href="/archives">
                <i class="menu-item-icon icon-archives"></i> <br />
          
          archives
        </a>
      </li>
    
      
          
            <li class="menu-item menu-item-contact sidebar-toggle2">
              <a href="javascript:;">
                <i class="menu-item-icon icon-about"></i> <br />
          
          contact
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
            
          

          <div id="posts" class="posts-expand">
            
  

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              Schema for Content Selection Architectures
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          
            Posted on 2016-04-01
          
        </span>
        
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <p>This is a summary of Michael Mateas’ Interactive Storytelling class in the Spring quarter of 2016 at UC Santa Cruz. The topic of this day’s class was a schema for content selection architectures, or a really general framework for categorizing the way systems select which/when content they want to display.</p>
<a id="more"></a>
<p>Content selection architectures are a type of system which produce content that is picked by a selection algorithm and displayed through an interface. This definition is broad and enables one to see beyond the scope of any specific medium, like the computer, in order to see the underlying systems that produce content that a game player will consume. Content is the stuff which the player is intended to consume, like the text on a page. The interface is what the player engages with in order to access this content, like a book. The algorithm that selects which content will be displayed by the user’s input to the interface is the selection algorithm, like the directions “go to page 5” when the player is on page 2 of a Choose Your Own adventure game. These aspects of the content selection architectures have a variety of concrete realizations, but generally a system that can be split into these categories is called a content selection architecture. </p>
<p>Mateas introduced the idea of a schema to generalize across these content selection architectures. If any number of concrete systems can be grouped into a set of content selection architectures, then a schema is like a generalization of those architectures as a whole. The following schema that Mateas diagrammed is intended to not be the one and only schema, just one of the many such types of schemas.</p>
<div style="display: block; text-align: center"><img src="mateas_schema.png" width="600" height="400"><br><em>Fig. 1 - Mateas’ schema for content selection architectures.</em><br></div>

<p>What each of these categories are and how they function is best done through a brief examination of the game’s Mateas examined. <i>The Cavern of Doom</i> is a Choose Your Own Adventure book where the reader progresses through a narrative and occasionally given the option to choose between two or more pages to flip through that continue the narrative in different ways. These books have multiple ending but the player, if it is their first playthrough, unknowingly chooses an ending as a result of their earlier decisions. </p>
<div style="display: block; text-align: center"><img src="cod.png" width="200" height="400"><br><em>Fig. 2 - The cover of the Choose Your Own Adventure book, <i>The Cavern of Doom</i>. @<a href="http://samizdat.cc/cyoa" target="_blank" rel="external">Christian Swinehart</a></em><br></div>

<p><i>The Cavern of Doom</i> can be understood through the schema Mateas described. Imagining ourselves re-designing the game, we began to break the concrete realization of the game in book form as a series of abstractions in the schema. The content pool of <i>The Cavern of Doom</i> could be the text that describes the story. That content pool could be broken down into packets of metadata and “opaque data.” The “opaque data” is the part of the packet of content that is unknown to the system, so perhaps the “opaque data” in one design could be the actual text itself. The metadata is the part of the data that the system can reason over. A simple, but effective piece of metadata could be the page number that the text is on. The content selection mechanism, then, would simply be to request that the content pool send the correct page number when it’s needed. The player’s actions, through the interface, would be the primary driver of when the next page is needed. Thus in this design, the player clicks with a mouse onto a page of text thereby requesting the next set of text that should be displayed. The content selection mechanism decides which is the next page by looking at the metadata of the current page and requests the correct next page from the content pool. The content pool sends the “opaque data” to the content selection mechanism. Here, the mechanism would not need to transform the data at all and so instantiating the “opaque data” in this case is merely a matter of passing the data on towards the interface. The interface then displays the next page.</p>
<p>A great amount of creativity comes in exploring the design space that the schema is general enough to allow for. For example, the interface need not be a mouse attached to a computer. Why not use something like the Kinect to track body motion? Mateas noted the additional rhetorical effects and computational complexity it would require if the player had to make themselves small or large in order to choose certain options in a Choose Your Own Adventure game. What if the metadata also contained “points” that ranked the various texts? The content selection mechanism could then reason over these points and decide which options are available to the player based on their past performance as opposed to simply choosing a pre-authored next page.</p>
<p>In some instances, the concrete reality of the hardware imposes limits to the potential design space the schema allows for. One of Mateas’ examples was the game <i>Dragon’s Lair</i>. FMV, or full motion video, was a visually impressive technology for its time whereby a laser disc image could be displayed on the screen of a video game cabinet. This was substantially higher resolution than its contemporaries that relied on low resolution pixel art. However, the video would slow, skip and then proceed at the normal rate whenever the game required a different scene to be skipped to. The game does not skip when the player continually makes successful moves, but does skip when they make mistakes and receive a fail screen. The designers, then, had to have designed their content pool and selection mechanism in such a way that facilitated this. </p>
<div style="display: block; text-align: center"><img src="dragonslair.png" width="400" height="400"><br><em>Fig. 3 - A screenshot of <i>Dragon’s Lair</i>, a FMV game from the 80’s.</em><br></div>

<p>Other times the schema seems to be unable to categorize and explain certain phenomena found in games. Mateas relied on the work of <a href="http://samizdat.cc/cyoa" target="_blank" rel="external">Christian Swinehart</a> to visually break down the options availiable to a player at any given moment in another Choosen Your Own Adventure game, <i>Inside UFO 54-40</i>. </p>
<div style="display: block; text-align: center"><img src="legend.png" width="300" height="400"><br><em>Fig. 4 - Legend for reading the visualization of narrative structure in <i>Inside UFO 54-40</i>. @<a href="http://samizdat.cc/cyoa" target="_blank" rel="external">Christian Swinehart</a>.</em><br></div>

<div style="display: block; text-align: center"><img src="ufo.png" width="400" height="400"><br><em>Fig. 5 Visual breakdown of the options available to the reader of <i>Inside UFO 54-40</i>. @<a href="http://samizdat.cc/cyoa" target="_blank" rel="external">Christian Swinehart</a>.</em><br></div>

<p>Among the vast network of choices and endings available to the player, a lone two nodes hide in the bottom right corner. The lone blue node is the ending were by the player finds the utopia they have been looking for the entire time. However, the aloneness means that the player will never get their by following the rules of the Choose Your Own Adventure book. The player must break the rules and flip the pages until they find the hidden page with this ending. This “breaking” of the mechanics becomes clever in this instance because it fits in with a larger message the designers intended regarding the search for our own utopias in our lives. However, this breaking is unrepresentable in the schema Mateas outlined. What needs to change about the schema in order to represent this breaking is the ability for the interface to index directly into the content pool, bypassing the selection mechanism altogether.</p>
<p>Mateas’ schema is helpful in outlining the design space of a huge variety of content selection architectures. Taking concrete examples from Choose Your Own Adventure books, the potential of the schema to categorize content selection architectures was tested. For books like <i>The Cavern of Doom</i>, the schema was helpful in the systematic generation of many types of content selection architectures. Our collective creativity was easily channeled through the categories laid forth by Mateas’ schema, as evidenced by the creative reimagining of <i>The Cavern of Doom</i> with the Kinect as the interface, for example. The schema was shown to be flexible in the face of design constraints, such as with <i>Dragon’s Lair</i>’s hardware concerns. However, the schema could be augmented with a few more relationships between categories, such as the ability for the interface to index into the content pool as was shown in the example with <i>Inside UFO 54-40</i>.</p>

        
      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/mateas-michael-interactive-storytelling-story-telling-santa-cruz-uc-class-schema-content-selection-architecture-games-game-system-systems-2016-framework-content-cavern-doom-dragon-s-dragon-dragons-lair-ufo-54-40/">
                #mateas, michael, interactive, storytelling, story, telling, santa, cruz, uc, class, schema, content, selection, architecture, games, game, system, systems, 2016, framework, content, cavern, doom, dragon's, dragon, dragons, lair, ufo, 54-40
              </a>
            
          </div>
        

        
          <div class="post-nav">
            <div class="post-nav-prev post-nav-item">
              
                <a href="/2016/08/Upgrading-a-Legacy-Alienware-Computer/">Upgrading a Legacy Alienware Computer</a>
              
            </div>

            <div class="post-nav-next post-nav-item">
              
                <a href="/2015/08/Contributing-to-Bridge-Troll-Junior-Jump-Day-4/">Contributing to Bridge Troll, Junior Jump Day 4</a>
              
            </div>
          </div>
        

        
        
      </div>
    
  </div>



  
    <div class="comments" id="comments">
      
    </div>
  

          </div>

          
        </div>

        
<div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>

<div id="sidebar" class="sidebar">
  <div class="sidebar-inner">

    
      <ul class="sidebar-nav motion-element" id='sidebar-nav ispost'>
        <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
          Table Of Contents
        </li>
        <li class="sidebar-nav-overview" data-target="site-overview">
          Overview
        </li>
      </ul>
    

    <div class="site-overview">
      <div class="site-author motion-element">
        <img class="site-author-image" src="/images/default_avatar.jpg" alt="Tyler Brothers" />
        <p class="site-author-name">Tyler Brothers</p>
      </div>
      <p class="site-description motion-element"></p>
      <div class="site-state motion-element">
        <div class="site-state-item site-state-posts">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">posts</span>
        </div>
        <div class="site-state-item site-state-tags">
            <span class="site-state-item-count">8</span>
            <span class="site-state-item-name">tags</span>
        </div>
        <div class="site-state-item site-state-pages">
            <span class="site-state-item-count">0</span>
            <span class="site-state-item-name">pages</span>
        </div>
      </div>
      <div class="site-author-contact motion-element">
        <p class="site-author-contact">Get in touch</p>
        <p class="site-author-contact-mail"><i class="icon-pen"></i> tylerbrothers1@gmail.com</p>
        <a href="https://github.com/possibly" target="_blank" class="site-author-contact-github"><i class="icon-star"></i> https://github.com/possibly</a>
      </div>

      

      <div class="social-info motion-element">
        
      </div>

      
      

    </div>

    
      <div class="post-toc-wrap sidebar-panel-active">
        <div class="post-toc-indicator-top post-toc-indicator"></div>
        <div class="post-toc">
          
          
            <p class="post-toc-empty">This post does not have a Table Of Contents</div>
          
        </div>
        <div class="post-toc-indicator-bottom post-toc-indicator"></div>
      </div>
    

  </div>
</div>


      </div>
    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2016
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Tyler Brothers</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT</a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $(".fancybox").fancybox();
    });
  </script>

  <script type="text/javascript">
  function hasMobileUA () {
    var nav = window.navigator;
    var ua = nav.userAgent;
    var pa = /iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g;

    return pa.test(ua);
  }

  function isDesktop () {
    return screen.width > 991 && !hasMobileUA();
  }

  function isTablet () {
    return screen.width < 992 && screen.width > 767 && hasMobileUA();
  }

  function isMobile () {
    return screen.width < 767 && hasMobileUA();
  }

  function escapeSelector (selector) {
    return selector.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g, "\\$&")
  }
</script>

  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  

  <script type="text/javascript" id="motion.global">
  $(document).ready(function () {
    var body = $('body');
    var isSidebarVisible = false;
    var sidebarToggle = $('.sidebar-toggle');
    var sidebarToggleLine1st = $('.sidebar-toggle-line-first')
    var sidebarToggleLine2nd = $('.sidebar-toggle-line-middle');
    var sidebarToggleLine3rd = $('.sidebar-toggle-line-last');
    var sidebar = $('.sidebar');

    var SIDEBAR_WIDTH = '320px';
    var SIDEBAR_DISPLAY_DURATION = 300;

    var sidebarToogleLineStatusInit = {width: '100%', opacity: 1, left: 0, rotateZ: 0, top: 0};

    var sidebarToggleLine1stStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine1stStatusArrow = {width: '50%', rotateZ: '-45deg', top: '2px'};
    var sidebarToogleLine1stStatusClose = {width: '100%', rotateZ: '-45deg', top: '5px'};

    var sidebarToggleLine2ndStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine2ndStatusArrow = {width: '90%'};
    var sidebarToogleLine2ndStatusClose = {opacity: 0};

    var sidebarToggleLine3rdStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine3rdStatusArrow = {width: '50%', rotateZ: '45deg', top: '-2px'};
    var sidebarToogleLine3rdStatusClose = {width: '100%', rotateZ: '45deg', top: '-5px'};

    sidebatToggleMotion();
    postsListMotion();
    backToTopMotion();


    $(document)
      .on('sidebar.isShowing', function () {
        isDesktop() && body.velocity(
          {paddingRight: SIDEBAR_WIDTH},
          SIDEBAR_DISPLAY_DURATION
        );
        sidebarContentMotion();
      })
      .on('sidebar.isHiding', function () {});


    function backToTopMotion () {
      var b2top = $('.back-to-top');
      b2top.on('click', function () {
        body.velocity('scroll');
      });
    }

    function sidebarShowMotion () {

      sidebarToggleLine1st.velocity(sidebarToogleLine1stStatusClose);
      sidebarToggleLine2nd.velocity(sidebarToogleLine2ndStatusClose);
      sidebarToggleLine3rd.velocity(sidebarToogleLine3rdStatusClose);

      sidebar.velocity({width: SIDEBAR_WIDTH}, {
        display: 'block',
        duration: SIDEBAR_DISPLAY_DURATION,
        complete: function () {
          sidebar.addClass('sidebar-active');
          sidebar.trigger('sidebar.didShow');
        }
      });
      sidebar.trigger('sidebar.isShowing');
    }

    function sidebarHideMotion () {
      isDesktop() && body.velocity({paddingRight: 0});
      sidebar.velocity('reverse');

      sidebarToggleLine1st.velocity(sidebarToggleLine1stStatusInit);
      sidebarToggleLine2nd.velocity(sidebarToggleLine2ndStatusInit);
      sidebarToggleLine3rd.velocity(sidebarToggleLine3rdStatusInit);

      sidebar.removeClass('sidebar-active');
      sidebar.trigger('sidebar.isHiding');
    };

    function sidebarContentMotion () {
      $('.sidebar .motion-element').velocity(
        'transition.slideRightIn',
        {stagger: 50, drag: true}
      );
    }

    function postsListMotion () {
      var postMotionOptions = postMotionOptions || {stagger: 300, drag: true};
      $('.post').velocity('transition.slideDownIn', postMotionOptions);
    }

    function sidebatToggleMotion () {
      sidebarToggle.on('click', function () {
        isSidebarVisible ? sidebarHideMotion() : sidebarShowMotion();
        isSidebarVisible = !isSidebarVisible;
      });

      // For 'Contact' navbar button.
      $('.sidebar-toggle2').on('click', function () {

        // Check if we are in a post.
        if ( $('#sidebar-nav ispost') ){
          // Make the SideBar visible if its not already.
          // Make the Overview section visible if its not already.
          if ( !isSidebarVisible && !$("[data-target='site-overview']").hasClass('sidebar-nav-overview sidebar-nav-active') ){ 
            sidebarShowMotion(); 
            $('.sidebar-nav li').trigger('click');
            isSidebarVisible = !isSidebarVisible;
          }
          // SideBar is already visible.
          // Make the Overview section visible if its not already.
          else if(isSidebarVisible && !$("[data-target='site-overview']").hasClass('sidebar-nav-overview sidebar-nav-active')){
            $('.sidebar-nav li').trigger('click');
          }
          // SideBar is already visible
          // Overview section is already visible
          // Act like a normal toggle.
          else {
            isSidebarVisible ? sidebarHideMotion() : sidebarShowMotion();
            isSidebarVisible = !isSidebarVisible;
          }

        // Not in a post, behave like normal.
        }else{
          isSidebarVisible ? sidebarHideMotion() : sidebarShowMotion();
          isSidebarVisible = !isSidebarVisible;
        }
      });

      sidebarToggle.hover(function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusArrow);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusArrow);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusArrow);
      }, function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusInit);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusInit);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusInit);
      });
    }
  });

</script>





  
  
<script type="text/javascript" id="bootstrap.scrollspy.custom">
  /* ========================================================================
  * Bootstrap: scrollspy.js v3.3.2
  * http://getbootstrap.com/javascript/#scrollspy
  * ========================================================================
  * Copyright 2011-2015 Twitter, Inc.
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
  * ======================================================================== */

  /**
   * Custom by iissnan
   *
   * - Add a `clear.bs.scrollspy` event.
   * - Esacpe targets selector.
   */


  +function ($) {
    'use strict';

    // SCROLLSPY CLASS DEFINITION
    // ==========================

    function ScrollSpy(element, options) {
      this.$body          = $(document.body)
      this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)
      this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)
      this.selector       = (this.options.target || '') + ' .nav li > a'
      this.offsets        = []
      this.targets        = []
      this.activeTarget   = null
      this.scrollHeight   = 0

      this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))
      this.refresh()
      this.process()
    }

    ScrollSpy.VERSION  = '3.3.2'

    ScrollSpy.DEFAULTS = {
      offset: 10
    }

    ScrollSpy.prototype.getScrollHeight = function () {
      return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
    }

    ScrollSpy.prototype.refresh = function () {
      var that          = this
      var offsetMethod  = 'offset'
      var offsetBase    = 0

      this.offsets      = []
      this.targets      = []
      this.scrollHeight = this.getScrollHeight()

      if (!$.isWindow(this.$scrollElement[0])) {
        offsetMethod = 'position'
        offsetBase   = this.$scrollElement.scrollTop()
      }

      this.$body
        .find(this.selector)
        .map(function () {
          var $el   = $(this)
          var href  = $el.data('target') || $el.attr('href')
          var $href = /^#./.test(href) && $(escapeSelector(href)) // Need to escape selector.

          return ($href
            && $href.length
            && $href.is(':visible')
            && [[$href[offsetMethod]().top + offsetBase, href]]) || null
        })
        .sort(function (a, b) { return a[0] - b[0] })
        .each(function () {
          that.offsets.push(this[0])
          that.targets.push(this[1])
        })


    }

    ScrollSpy.prototype.process = function () {
      var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset
      var scrollHeight = this.getScrollHeight()
      var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()
      var offsets      = this.offsets
      var targets      = this.targets
      var activeTarget = this.activeTarget
      var i

      if (this.scrollHeight != scrollHeight) {
        this.refresh()
      }

      if (scrollTop >= maxScroll) {
        return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)
      }

      if (activeTarget && scrollTop < offsets[0]) {
        $(this.selector).trigger('clear.bs.scrollspy')  // Add a custom event.
        this.activeTarget = null
        return this.clear()
      }

      for (i = offsets.length; i--;) {
        activeTarget != targets[i]
          && scrollTop >= offsets[i]
          && (!offsets[i + 1] || scrollTop <= offsets[i + 1])
          && this.activate(targets[i])
      }
    }

    ScrollSpy.prototype.activate = function (target) {
      this.activeTarget = target

      this.clear()

      var selector = this.selector +
        '[data-target="' + target + '"],' +
        this.selector + '[href="' + target + '"]'

      var active = $(selector)
        .parents('li')
        .addClass('active')

      if (active.parent('.dropdown-menu').length) {
        active = active
          .closest('li.dropdown')
          .addClass('active')
      }

      active.trigger('activate.bs.scrollspy')
    }

    ScrollSpy.prototype.clear = function () {
      $(this.selector)
        .parentsUntil(this.options.target, '.active')
        .removeClass('active')
    }


    // SCROLLSPY PLUGIN DEFINITION
    // ===========================

    function Plugin(option) {
      return this.each(function () {
        var $this   = $(this)
        var data    = $this.data('bs.scrollspy')
        var options = typeof option == 'object' && option

        if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))
        if (typeof option == 'string') data[option]()
      })
    }

    var old = $.fn.scrollspy

    $.fn.scrollspy             = Plugin
    $.fn.scrollspy.Constructor = ScrollSpy


    // SCROLLSPY NO CONFLICT
    // =====================

    $.fn.scrollspy.noConflict = function () {
      $.fn.scrollspy = old
      return this
    }


    // SCROLLSPY DATA-API
    // ==================

    $(window).on('load.bs.scrollspy.data-api', function () {
      $('[data-spy="scroll"]').each(function () {
        var $spy = $(this)
        Plugin.call($spy, $spy.data())
      })
    })

  }(jQuery);
</script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var $sidebarInner = $('.sidebar-inner');
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.didShow', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;
          var self = this;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      $(indicator).velocity('stop').velocity({
        opacity: action === 'show' ? 0.4 : 0
      }, { duration: 100 });
    }

  });
</script>


  <script type="text/javascript" id="sidebar.nav">
    $(document).ready(function () {
      var html = $('html');

      $('.sidebar-nav li').on('click', function () {
        var item = $(this);
        var activeTabClassName = 'sidebar-nav-active';
        var activePanelClassName = 'sidebar-panel-active';
        if (item.hasClass(activeTabClassName)) {
          return;
        }

        var currentTarget = $('.' + activePanelClassName);
        var target = $('.' + item.data('target'));

        currentTarget.velocity('transition.slideUpOut', 200, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', 200)
            .addClass(activePanelClassName);
        });

        item.siblings().removeClass(activeTabClassName);
        item.addClass(activeTabClassName);
      });

      $('.post-toc a').on('click', function (e) {
        e.preventDefault();
        var offset = $(escapeSelector(this.getAttribute('href'))).offset().top;
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        });
      });

      // Expand sidebar on post detail page by default, when post has a toc.
      if ($('.post-toc-content').html().trim().length > 0 && isDesktop()) {
        setTimeout(function () {
          $('.sidebar-toggle').trigger('click');
        }, 800);
      }
    });
  </script>




  

  
  

  


  
</body>
</html>
